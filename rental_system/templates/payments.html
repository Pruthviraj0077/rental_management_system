{% extends "layout.html" %}
{% block content %}
<div class="card">
  <div class="card-header bg-success text-white">
    <h4>Payment Management</h4>
  </div>
  <div class="card-body">

    <form method="GET" class="row g-3 mb-4">
      <div class="col-md-4"><input type="number" name="tenant_id" class="form-control" placeholder="Filter by Tenant ID" value="{{ tenant_id }}"></div>
      <div class="col-md-4">
        <select name="status" class="form-select">
          <option value="">All</option>
          <option value="pending" {% if status=='pending' %}selected{% endif %}>Pending</option>
          <option value="completed" {% if status=='completed' %}selected{% endif %}>Completed</option>
          <option value="advance" {% if status=='advance' %}selected{% endif %}>Advance</option>
        </select>
      </div>
      <div class="col-md-2"><button class="btn btn-secondary w-100">Filter</button></div>
    </form>

    <form method="POST" action="{{ url_for('add_payment') }}" class="row g-3 mb-4">
      <div class="col-md-3"><input type="number" name="tenant_id" class="form-control" placeholder="Tenant ID" required></div>
      <div class="col-md-3"><input type="number" name="rent" class="form-control" placeholder="Rent" required></div>
      <div class="col-md-3"><input type="number" name="amount_paid" class="form-control" placeholder="Amount Paid" required></div>
      <div class="col-md-3"><button class="btn btn-primary w-100">Add Payment</button></div>
    </form>

    <table class="table table-striped table-bordered table-hover align-middle">
      <thead class="table-success">
        <tr><th>ID</th><th>Tenant ID</th><th>Rent</th><th>Paid</th><th>Date</th><th>Status</th><th>Pending</th><th>Advance</th></tr>
      </thead>
      <tbody>
        {% for p in payments %}
        <tr>
          <td>{{ p.id }}</td><td>{{ p.tenant_id }}</td><td>{{ p.rent }}</td><td>{{ p.amount_paid }}</td>
          <td>{{ p.payment_date }}</td>
          <td>
            {% if p.status == 'pending' %}
              <span class="badge bg-danger">Pending</span>
            {% elif p.status == 'advance' %}
              <span class="badge bg-info">Advance</span>
            {% else %}
              <span class="badge bg-success">Completed</span>
            {% endif %}
          </td>
          <td>{{ p.pending_amount }}</td><td>{{ p.advance_amount }}</td>
        </tr>
        {% else %}
        <tr><td colspan="8" class="text-center text-muted">No payments found.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
